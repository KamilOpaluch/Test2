javascript:(function(){function S(s){return s==null?"":String(s).replace(/\s+/g," ").trim()}function dl(blob,name){var a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download=name;document.body.appendChild(a);a.click();a.remove();setTimeout(()=>URL.revokeObjectURL(a.href),500)}function toCSV(arr){return arr.map(r=>r.map(v=>'"'+String(v??"").replace(/"/g,'""')+'"').join(",")).join("\r\n")}function pickBiggestContainer(rows){if(rows.length===0)return null;let best=null,bestCount=0;rows.forEach(r=>{let p=r.parentElement;while(p&&p!==document.body){const c=p.querySelectorAll('[role="row"]').length;if(c>bestCount){best=p;bestCount=c}p=p.parentElement}});return best||rows[0].parentElement}function collect(){/* 1) Native <table> */var t=document.querySelector("table");if(t){var data=[];t.querySelectorAll("tr").forEach(tr=>{data.push(Array.from(tr.querySelectorAll("th,td")).map(td=>S(td.innerText))) });return data.filter(r=>r.length)}/* 2) ARIA grid */var grid=document.querySelector('[role="grid"]');if(grid){var data2=[],heads=Array.from(grid.querySelectorAll('[role="columnheader"]')).map(h=>S(h.innerText));if(heads.length)data2.push(heads);Array.from(grid.querySelectorAll('[role="row"]')).forEach(r=>{if(r.querySelector('[role="columnheader"]'))return;var cells=Array.from(r.querySelectorAll('[role="gridcell"],[role="cell"]')).map(c=>S(c.innerText));if(cells.length)data2.push(cells)});if(data2.length>0)return data2}/* 3) Generic div grid: role=row + div cells / tabindex */var rows=Array.from(document.querySelectorAll('[role="row"]'));if(rows.length){var container=pickBiggestContainer(rows);if(container){var hdr=Array.from(container.querySelectorAll('[role="row"]')).find(r=>r.querySelector('[role="columnheader"]'));var data3=[];if(hdr){var h=Array.from(hdr.querySelectorAll('[role="columnheader"],div,span')).map(x=>S(x.innerText)).filter(Boolean);if(h.length)data3.push(h)}Array.from(container.querySelectorAll('[role="row"]')).forEach(r=>{if(r===hdr)return;var cells=Array.from(r.querySelectorAll('[role="gridcell"],[role="cell"],div[tabindex]')).map(c=>S(c.innerText)).filter((v,i,arr)=>!(arr.length===1 && v===""));if(cells.length>1|| (cells.length===1 && S(cells[0])!==""))data3.push(cells)});if(data3.length>0)return data3}}/* 4) Last-resort: dense div grid under a scroller */var scrollers=Array.from(document.querySelectorAll('div,section')).filter(el=>{var st=getComputedStyle(el);return /(auto|scroll)/.test(st.overflow+st.overflowY+st.overflowX)});for(const sc of scrollers){var rows2=Array.from(sc.querySelectorAll('div[tabindex], [data-row-index]'));if(rows2.length>5){var data4=[];rows2.forEach(r=>{var cells=Array.from(r.children).map(c=>S(c.innerText)).filter(Boolean);if(!cells.length){cells=Array.from(r.querySelectorAll('div,span')).map(c=>S(c.innerText)).filter(Boolean)}if(cells.length)data4.push(cells)});if(data4.length>0)return data4}}return null}function exportData(A){if(!A||!A.length){alert("No table-like data found.");return}var width=Math.max.apply(null,A.map(r=>r.length));A=A.map(r=>r.concat(Array(Math.max(0,width-r.length)).fill("")));function doXLSX(){try{var ws=XLSX.utils.aoa_to_sheet(A);var wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,"Sheet1");var out=XLSX.write(wb,{bookType:"xlsx",type:"array"});dl(new Blob([out],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"pvalue.xlsx")}catch(e){console.warn("XLSX failed, falling back to CSV:",e);dl(new Blob([toCSV(A)],{type:"text/csv;charset=utf-8;"}),"pvalue.csv")}}if(window.XLSX){doXLSX()}else{var s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js";s.onload=doXLSX;s.onerror=function(){dl(new Blob([toCSV(A)],{type:"text/csv;charset=utf-8;"}),"pvalue.csv")};document.head.appendChild(s)}}var data=collect();if(!data){alert("No table found on this page. Try scrolling the grid into view, or expanding rows.");return}exportData(data);})();
